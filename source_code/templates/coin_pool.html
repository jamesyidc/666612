<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>å¸ç§æ±  - ä»æ˜Ÿæ˜Ÿç³»ç»Ÿç­›é€‰çš„ä¼˜è´¨å¸ç§æ± </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #0f766e 0%, #059669 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container {
            max-width: 420px;
            width: 100%;
        }

        .back-btn {
            display: inline-block;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            text-decoration: none;
            color: #fff;
            margin-bottom: 20px;
            transition: all 0.3s;
            font-size: 14px;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* ä¸»å¡ç‰‡ */
        .main-card {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
            color: white;
            margin-bottom: 30px;
            border: 3px solid rgba(255, 255, 255, 0.3);
        }

        /* æ ‡é¢˜ */
        .title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }

        .subtitle {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
            line-height: 1.6;
        }

        /* å¸ç§åˆ—è¡¨æ¡† */
        .coin-box {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            text-align: left;
        }

        .coin-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .coin-row:last-child {
            border-bottom: none;
        }

        .coin-label {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.8);
            flex-shrink: 0;
            font-weight: 500;
        }

        .coin-value {
            font-size: 13px;
            color: white;
            font-weight: 500;
            flex: 1;
            text-align: right;
            word-break: break-word;
        }

        .coin-count {
            font-weight: bold;
            margin-left: 5px;
        }

        /* é¢œè‰²æ ‡è®° */
        .badge-v1 {
            color: #fbbf24;
        }

        .badge-v2 {
            color: #60a5fa;
        }

        .badge-rush-up {
            color: #4ade80;
        }

        .badge-rush-gt {
            color: #34d399;
        }

        .badge-priority {
            color: #fb923c;
        }

        .badge-long-pool {
            color: #22c55e;
            font-weight: 600;
        }

        .badge-short-pool {
            color: #ef4444;
            font-weight: 600;
        }

        /* åšå¤šå¸ç§æ± å¡ç‰‡ */
        .long-pool-card {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
            color: white;
            margin-bottom: 30px;
            border: 3px solid rgba(255, 255, 255, 0.3);
        }

        /* åšç©ºå¸ç§æ± å¡ç‰‡ */
        .short-pool-card {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
            color: white;
            margin-bottom: 30px;
            border: 3px solid rgba(255, 255, 255, 0.3);
        }

        .long-pool-title, .short-pool-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .long-pool-subtitle, .short-pool-subtitle {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
        }

        .long-pool-coins, .short-pool-coins {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }

        .long-pool-count, .short-pool-count {
            font-size: 48px;
            font-weight: 900;
            color: #fbbf24;
            margin-bottom: 15px;
            text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.3);
        }

        .long-pool-list, .short-pool-list {
            font-size: 15px;
            line-height: 1.8;
            color: white;
            font-weight: 500;
        }

        .coin-frequency {
            display: inline-block;
            background: rgba(251, 191, 36, 0.3);
            padding: 2px 8px;
            border-radius: 8px;
            margin-left: 3px;
            font-size: 12px;
            color: #fbbf24;
            font-weight: bold;
        }

        /* æŸ¥çœ‹è¯¦æƒ…æŒ‰é’® */
        .detail-btn {
            display: inline-block;
            padding: 15px 50px;
            background: rgba(255, 255, 255, 0.95);
            color: #10b981;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .detail-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        /* æ›´æ–°æ—¶é—´ */
        .update-time {
            margin-top: 20px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 16px;
        }

        @media (max-width: 480px) {
            .main-card {
                padding: 30px 20px;
            }

            .title {
                font-size: 24px;
            }

            .coin-label {
                font-size: 12px;
                width: 80px;
            }

            .coin-value {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="/" class="back-btn">â† è¿”å›é¦–é¡µ</a>
        
        <div id="loading" class="loading">
            åŠ è½½ä¸­...
        </div>

        <div id="content" style="display: none;">
            <!-- åšå¤šå¸ç§æ± å¡ç‰‡ -->
            <div class="long-pool-card">
                <div class="long-pool-title">
                    ğŸš€ åšå¤šå¸ç§æ± 
                </div>
                <div class="long-pool-subtitle">å‡ºç°2æ¬¡åŠä»¥ä¸Šçš„é«˜é¢‘ä¼˜è´¨å¸ç§</div>
                <div class="long-pool-coins">
                    <div class="long-pool-count" id="long-pool-count">0</div>
                    <div class="long-pool-list" id="long-pool-list">-</div>
                </div>
            </div>

            <!-- åšç©ºå¸ç§æ± å¡ç‰‡ -->
            <div class="short-pool-card">
                <div class="short-pool-title">
                    ğŸ“‰ åšç©ºå¸ç§æ± 
                </div>
                <div class="short-pool-subtitle">æ»¡è¶³2ä¸ªåŠä»¥ä¸Šæ¡ä»¶çš„åšç©ºå¸ç§</div>
                <div class="short-pool-coins">
                    <div class="short-pool-count" id="short-pool-count">0</div>
                    <div class="short-pool-list" id="short-pool-list">-</div>
                </div>
            </div>

            <!-- åšå¤šå¸ç§æ± è¯¦æƒ…å¡ç‰‡ -->
            <div class="main-card" style="background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);">
                <!-- æ ‡é¢˜ -->
                <h1 class="title">ğŸš€ åšå¤šå¸ç§æ± </h1>
                <p class="subtitle">ä»æ˜Ÿæ˜Ÿç³»ç»Ÿç­›é€‰çš„ä¼˜è´¨å¸ç§æ± ï¼Œ5å¤§ç»´åº¦æ™ºèƒ½åˆ†ç±»</p>

                <!-- å¸ç§åˆ—è¡¨ -->
                <div class="coin-box">
                    <div class="coin-row">
                        <span class="coin-label">V1å¸ç§:</span>
                        <span class="coin-value">
                            <span class="badge-v1 coin-count" id="v1-count">0ä¸ª</span>
                        </span>
                    </div>
                    <div class="coin-row" style="border-bottom: 2px solid rgba(255, 255, 255, 0.15); padding-bottom: 15px; margin-bottom: 15px;">
                        <span class="coin-value badge-v1" id="v1-coins" style="text-align: left; padding-left: 0;">-</span>
                    </div>

                    <div class="coin-row">
                        <span class="coin-label">V2å¸ç§:</span>
                        <span class="coin-value">
                            <span class="badge-v2 coin-count" id="v2-count">0ä¸ª</span>
                        </span>
                    </div>
                    <div class="coin-row" style="border-bottom: 2px solid rgba(255, 255, 255, 0.15); padding-bottom: 15px; margin-bottom: 15px;">
                        <span class="coin-value badge-v2" id="v2-coins" style="text-align: left; padding-left: 0;">-</span>
                    </div>

                    <div class="coin-row">
                        <span class="coin-label">æ€¥æ¶¨>æ€¥è·Œ:</span>
                        <span class="coin-value">
                            <span class="badge-rush-gt coin-count" id="rush-gt-count">0ä¸ª</span>
                        </span>
                    </div>
                    <div class="coin-row" style="border-bottom: 2px solid rgba(255, 255, 255, 0.15); padding-bottom: 15px; margin-bottom: 15px;">
                        <span class="coin-value badge-rush-gt" id="rush-gt-coins" style="text-align: left; padding-left: 0;">-</span>
                    </div>

                    <div class="coin-row">
                        <span class="coin-label">åªæœ‰æ€¥æ¶¨:</span>
                        <span class="coin-value">
                            <span class="badge-rush-up coin-count" id="only-rush-count">0ä¸ª</span>
                        </span>
                    </div>
                    <div class="coin-row" style="border-bottom: 2px solid rgba(255, 255, 255, 0.15); padding-bottom: 15px; margin-bottom: 15px;">
                        <span class="coin-value badge-rush-up" id="only-rush-coins" style="text-align: left; padding-left: 0;">-</span>
                    </div>

                    <div class="coin-row">
                        <span class="coin-label">ä¼˜å…ˆçº§â‰¥4:</span>
                        <span class="coin-value">
                            <span class="badge-priority coin-count" id="priority-count">0ä¸ª</span>
                        </span>
                    </div>
                    <div class="coin-row" style="padding-bottom: 0;">
                        <span class="coin-value badge-priority" id="priority-coins" style="text-align: left; padding-left: 0;">-</span>
                    </div>
                </div>

                <!-- æŸ¥çœ‹è¯¦æƒ…æŒ‰é’® -->
                <a href="/star-system" class="detail-btn">æŸ¥çœ‹è¯¦æƒ…</a>

                <!-- æ›´æ–°æ—¶é—´ -->
                <div class="update-time" id="update-time">æœ€åæ›´æ–°: -</div>
            </div>

            <!-- åšç©ºå¸ç§æ± è¯¦æƒ…å¡ç‰‡ -->
            <div class="main-card" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); margin-top: 30px;">
                <!-- æ ‡é¢˜ -->
                <h1 class="title">ğŸ“‰ åšç©ºå¸ç§æ± </h1>
                <p class="subtitle">ç¬¦åˆåšç©ºæ¡ä»¶çš„å¸ç§æ± ï¼Œ4å¤§ç»´åº¦æ™ºèƒ½åˆ†ç±»</p>

                <!-- å¸ç§åˆ—è¡¨ -->
                <div class="coin-box">
                    <div class="coin-row">
                        <span class="coin-label">åªæœ‰æ€¥è·Œ:</span>
                        <span class="coin-value">
                            <span class="badge-rush-up coin-count" id="only-rush-down-count">0ä¸ª</span>
                        </span>
                    </div>
                    <div class="coin-row" style="border-bottom: 2px solid rgba(255, 255, 255, 0.15); padding-bottom: 15px; margin-bottom: 15px;">
                        <span class="coin-value badge-rush-up" id="only-rush-down-coins" style="text-align: left; padding-left: 0;">-</span>
                    </div>

                    <div class="coin-row">
                        <span class="coin-label">æ€¥è·Œ>æ€¥æ¶¨:</span>
                        <span class="coin-value">
                            <span class="badge-rush-gt coin-count" id="rush-down-gt-up-count">0ä¸ª</span>
                        </span>
                    </div>
                    <div class="coin-row" style="border-bottom: 2px solid rgba(255, 255, 255, 0.15); padding-bottom: 15px; margin-bottom: 15px;">
                        <span class="coin-value badge-rush-gt" id="rush-down-gt-up-coins" style="text-align: left; padding-left: 0;">-</span>
                    </div>

                    <div class="coin-row">
                        <span class="coin-label">V1æˆäº¤é‡:</span>
                        <span class="coin-value">
                            <span class="badge-v1 coin-count" id="short-v1-count">0ä¸ª</span>
                        </span>
                    </div>
                    <div class="coin-row" style="border-bottom: 2px solid rgba(255, 255, 255, 0.15); padding-bottom: 15px; margin-bottom: 15px;">
                        <span class="coin-value badge-v1" id="short-v1-coins" style="text-align: left; padding-left: 0;">-</span>
                    </div>

                    <div class="coin-row">
                        <span class="coin-label">V2æˆäº¤é‡:</span>
                        <span class="coin-value">
                            <span class="badge-v2 coin-count" id="short-v2-count">0ä¸ª</span>
                        </span>
                    </div>
                    <div class="coin-row" style="padding-bottom: 0;">
                        <span class="coin-value badge-v2" id="short-v2-coins" style="text-align: left; padding-left: 0;">-</span>
                    </div>
                </div>

                <!-- æŸ¥çœ‹è¯¦æƒ…æŒ‰é’® -->
                <a href="/star-system" class="detail-btn" style="background: rgba(255, 255, 255, 0.95); color: #ef4444;">æŸ¥çœ‹è¯¦æƒ…</a>

                <!-- æ›´æ–°æ—¶é—´ -->
                <div class="update-time" id="update-time-short">æœ€åæ›´æ–°: -</div>
            </div>

            <!-- æ–°å¢ï¼šä¸‰å¤§è¶‹åŠ¿æ•°æ®æ¡† -->
            <div style="margin-top: 30px; display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px;">
                <!-- å¤§è¶‹åŠ¿ -->
                <div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.35) 0%, rgba(118, 75, 162, 0.35) 100%); border: 3px solid rgba(102, 126, 234, 0.7); border-radius: 20px; padding: 30px; box-shadow: 0 8px 20px rgba(0,0,0,0.2);">
                    <div style="font-size: 22px; font-weight: bold; color: #a5b4fc; margin-bottom: 20px; text-align: center; text-shadow: 1px 1px 3px rgba(0,0,0,0.3);">
                        ğŸ“ˆ å¤§è¶‹åŠ¿åˆ¤æ–­
                    </div>
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 14px; color: rgba(255,255,255,0.8); margin-bottom: 12px;">å½“å‰è¶‹åŠ¿å¾—åˆ†</div>
                        <div id="macro-trend-score" style="font-size: 64px; font-weight: 900; color: #10b981; margin-bottom: 12px; text-shadow: 2px 2px 6px rgba(0,0,0,0.3);">-</div>
                        <div id="macro-trend-text" style="font-size: 20px; font-weight: bold; color: #10b981; text-shadow: 1px 1px 3px rgba(0,0,0,0.2);">-</div>
                    </div>
                    <!-- å¾—åˆ†è¯´æ˜ -->
                    <div style="background: rgba(0,0,0,0.2); border-radius: 12px; padding: 15px; margin-top: 15px;">
                        <div style="font-size: 13px; color: rgba(255,255,255,0.85); line-height: 1.8;">
                            <div style="margin-bottom: 5px;">ğŸ“Š åŸºäºå› å­ï¼š</div>
                            <div id="macro-factors" style="margin-left: 8px; color: rgba(255,255,255,0.75); font-size: 12px;">
                                â€¢ æ˜Ÿæ˜Ÿå·®å€¼<br>
                                â€¢ BTC æ¶¨è·Œå¹…<br>
                                â€¢ ETH æ¶¨è·Œå¹…
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ä¸­è¶‹åŠ¿ -->
                <div style="background: linear-gradient(135deg, rgba(255, 234, 167, 0.35) 0%, rgba(253, 203, 110, 0.35) 100%); border: 3px solid rgba(255, 193, 7, 0.7); border-radius: 20px; padding: 30px; box-shadow: 0 8px 20px rgba(0,0,0,0.2);">
                    <div style="font-size: 22px; font-weight: bold; color: #fbbf24; margin-bottom: 20px; text-align: center; text-shadow: 1px 1px 3px rgba(0,0,0,0.3);">
                        âš ï¸ ä¸­è¶‹åŠ¿é™åˆ¶
                    </div>
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 14px; color: rgba(255,255,255,0.8); margin-bottom: 12px;">é™åˆ¶æ¡ä»¶è§¦å‘</div>
                        <div id="medium-trend-count" style="font-size: 64px; font-weight: 900; color: #f59e0b; margin-bottom: 12px; text-shadow: 2px 2px 6px rgba(0,0,0,0.3);">-</div>
                        <div id="medium-trend-text" style="font-size: 18px; font-weight: bold; color: #f59e0b; text-shadow: 1px 1px 3px rgba(0,0,0,0.2);">-</div>
                    </div>
                    <!-- æƒé™çŠ¶æ€ -->
                    <div style="background: rgba(0,0,0,0.2); border-radius: 12px; padding: 15px; margin-top: 15px;">
                        <div style="font-size: 13px; color: rgba(255,255,255,0.85); line-height: 2;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span>ğŸ“ˆ åšå¤šæƒé™ï¼š</span>
                                <span id="can-long-status" style="font-weight: bold; font-size: 14px;">-</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span>ğŸ“‰ åšç©ºæƒé™ï¼š</span>
                                <span id="can-short-status" style="font-weight: bold; font-size: 14px;">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å°è¶‹åŠ¿ -->
                <div style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.35) 0%, rgba(5, 150, 105, 0.35) 100%); border: 3px solid rgba(16, 185, 129, 0.7); border-radius: 20px; padding: 30px; box-shadow: 0 8px 20px rgba(0,0,0,0.2);">
                    <div style="font-size: 22px; font-weight: bold; color: #10b981; margin-bottom: 20px; text-align: center; text-shadow: 1px 1px 3px rgba(0,0,0,0.3);">
                        ğŸ’° å°è¶‹åŠ¿ä»“ä½
                    </div>
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 14px; color: rgba(255,255,255,0.8); margin-bottom: 12px;">å»ºè®®æ€»ä»“ä½</div>
                        <div id="small-trend-position" style="font-size: 64px; font-weight: 900; color: #10b981; margin-bottom: 12px; text-shadow: 2px 2px 6px rgba(0,0,0,0.3);">-</div>
                        <div id="small-trend-text" style="font-size: 18px; font-weight: bold; color: #10b981; text-shadow: 1px 1px 3px rgba(0,0,0,0.2);">-</div>
                    </div>
                    <!-- ä»“ä½ç»†åˆ† -->
                    <div style="background: rgba(0,0,0,0.2); border-radius: 12px; padding: 15px; margin-top: 15px;">
                        <div style="font-size: 13px; color: rgba(255,255,255,0.85); line-height: 2;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span>â­ æ˜Ÿæ˜Ÿä»“ä½ï¼š</span>
                                <span id="star-position" style="font-weight: bold; font-size: 14px;">-</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span>ğŸ“Š æŒä»“é‡ä»“ä½ï¼š</span>
                                <span id="oi-position" style="font-weight: bold; font-size: 14px;">-</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // åŠ è½½æ•°æ®
        function loadData() {
            fetch('/api/star-system/data')
                .then(res => res.json())
                .then(data => {
                    if (data.success) {
                        // æ”¶é›†æ‰€æœ‰å¸ç§åˆ—è¡¨
                        const v1Coins = data.v1v2_data?.v1_coins || [];
                        const v2Coins = data.v1v2_data?.v2_coins || [];
                        const rushGt = data.coin_lists?.rush_up_gt_down_coins || [];
                        const onlyRush = data.coin_lists?.only_rush_up_coins || [];
                        const priority = data.coin_lists?.priority_high_coins || [];
                        
                        // ç»Ÿè®¡æ‰€æœ‰å¸ç§çš„å‡ºç°æ¬¡æ•°
                        const allCoins = [...v1Coins, ...v2Coins, ...rushGt, ...onlyRush, ...priority];
                        const frequencyMap = {};
                        allCoins.forEach(coin => {
                            frequencyMap[coin] = (frequencyMap[coin] || 0) + 1;
                        });
                        
                        // æŒ‰å‡ºç°æ¬¡æ•°æ’åºï¼ˆæ¬¡æ•°å¤šçš„åœ¨å‰ï¼‰
                        const sortedCoins = Object.keys(frequencyMap).sort((a, b) => {
                            return frequencyMap[b] - frequencyMap[a];
                        });
                        
                        // æ ¼å¼åŒ–å¸ç§æ˜¾ç¤ºï¼ˆæ·»åŠ å‡ºç°æ¬¡æ•°ï¼‰
                        function formatCoinsWithCount(coins) {
                            return coins.map(coin => `${coin}(${frequencyMap[coin]})`).join(', ');
                        }
                        
                        // V1å¸ç§ - æ˜¾ç¤ºå‡ºç°æ¬¡æ•°
                        document.getElementById('v1-count').textContent = v1Coins.length + 'ä¸ª';
                        document.getElementById('v1-coins').textContent = v1Coins.length > 0 ? formatCoinsWithCount(v1Coins) : '-';

                        // V2å¸ç§ - æ˜¾ç¤ºå‡ºç°æ¬¡æ•°
                        document.getElementById('v2-count').textContent = v2Coins.length + 'ä¸ª';
                        document.getElementById('v2-coins').textContent = v2Coins.length > 0 ? formatCoinsWithCount(v2Coins) : '-';
                        
                        // æ€¥æ¶¨>æ€¥è·Œ - æŒ‰å‡ºç°æ¬¡æ•°æ’åºå¹¶æ˜¾ç¤º
                        const rushGtSorted = rushGt.sort((a, b) => {
                            return sortedCoins.indexOf(a) - sortedCoins.indexOf(b);
                        });
                        document.getElementById('rush-gt-count').textContent = rushGtSorted.length + 'ä¸ª';
                        document.getElementById('rush-gt-coins').textContent = rushGtSorted.length > 0 ? formatCoinsWithCount(rushGtSorted) : '-';

                        // åªæœ‰æ€¥æ¶¨ - æŒ‰å‡ºç°æ¬¡æ•°æ’åºå¹¶æ˜¾ç¤º
                        const onlyRushSorted = onlyRush.sort((a, b) => {
                            return sortedCoins.indexOf(a) - sortedCoins.indexOf(b);
                        });
                        document.getElementById('only-rush-count').textContent = onlyRushSorted.length + 'ä¸ª';
                        document.getElementById('only-rush-coins').textContent = onlyRushSorted.length > 0 ? formatCoinsWithCount(onlyRushSorted) : '-';

                        // ä¼˜å…ˆçº§â‰¥4 - æŒ‰å‡ºç°æ¬¡æ•°æ’åºå¹¶æ˜¾ç¤º
                        const prioritySorted = priority.sort((a, b) => {
                            return sortedCoins.indexOf(a) - sortedCoins.indexOf(b);
                        });
                        document.getElementById('priority-count').textContent = prioritySorted.length + 'ä¸ª';
                        document.getElementById('priority-coins').textContent = prioritySorted.length > 0 ? formatCoinsWithCount(prioritySorted) : '-';

                        // åšå¤šå¸ç§æ±  - å‡ºç°å¤§äºç­‰äº2æ¬¡çš„å¸ç§
                        const longPoolCoins = sortedCoins.filter(coin => frequencyMap[coin] >= 2);
                        document.getElementById('long-pool-count').textContent = longPoolCoins.length;
                        
                        if (longPoolCoins.length > 0) {
                            const longPoolHtml = longPoolCoins.map(coin => {
                                const frequency = frequencyMap[coin];
                                return `${coin}<span class="coin-frequency">Ã—${frequency}</span>`;
                            }).join(', ');
                            document.getElementById('long-pool-list').innerHTML = longPoolHtml;
                        } else {
                            document.getElementById('long-pool-list').textContent = 'æš‚æ— ç¬¦åˆæ¡ä»¶çš„å¸ç§';
                        }

                        // åšç©ºå¸ç§æ±  - ç»Ÿè®¡ç¬¦åˆåšç©ºæ¡ä»¶çš„å¸ç§
                        const onlyRushDown = data.coin_lists?.only_rush_down_coins || [];
                        const rushDownGtUp = data.coin_lists?.rush_down_gt_up_coins || [];
                        
                        // æ”¶é›†æ‰€æœ‰åšç©ºæ¡ä»¶çš„å¸ç§ï¼ˆå»é‡ï¼‰
                        const shortConditionsMap = {};
                        
                        // 1. åªæœ‰æ€¥è·Œ
                        onlyRushDown.forEach(coin => {
                            if (!shortConditionsMap[coin]) shortConditionsMap[coin] = [];
                            shortConditionsMap[coin].push('åªæœ‰æ€¥è·Œ');
                        });
                        
                        // 2. æ€¥è·Œ>æ€¥æ¶¨
                        rushDownGtUp.forEach(coin => {
                            if (!shortConditionsMap[coin]) shortConditionsMap[coin] = [];
                            if (!shortConditionsMap[coin].includes('æ€¥è·Œ>æ€¥æ¶¨')) {
                                shortConditionsMap[coin].push('æ€¥è·Œ>æ€¥æ¶¨');
                            }
                        });
                        
                        // 3. V1æˆäº¤é‡
                        v1Coins.forEach(coin => {
                            if (!shortConditionsMap[coin]) shortConditionsMap[coin] = [];
                            if (!shortConditionsMap[coin].includes('V1')) {
                                shortConditionsMap[coin].push('V1');
                            }
                        });
                        
                        // 4. V2æˆäº¤é‡
                        v2Coins.forEach(coin => {
                            if (!shortConditionsMap[coin]) shortConditionsMap[coin] = [];
                            if (!shortConditionsMap[coin].includes('V2')) {
                                shortConditionsMap[coin].push('V2');
                            }
                        });
                        
                        // è·å–æ‰€æœ‰åšç©ºå¸ç§å¹¶æŒ‰æ¡ä»¶æ•°é‡æ’åºï¼Œç­›é€‰æ»¡è¶³>=2ä¸ªæ¡ä»¶çš„å¸ç§
                        const allShortPoolCoins = Object.keys(shortConditionsMap).sort((a, b) => {
                            return shortConditionsMap[b].length - shortConditionsMap[a].length;
                        });
                        
                        // åªæ˜¾ç¤ºæ»¡è¶³2ä¸ªåŠä»¥ä¸Šæ¡ä»¶çš„å¸ç§
                        const shortPoolCoins = allShortPoolCoins.filter(coin => shortConditionsMap[coin].length >= 2);
                        
                        document.getElementById('short-pool-count').textContent = shortPoolCoins.length;
                        
                        if (shortPoolCoins.length > 0) {
                            const shortPoolHtml = shortPoolCoins.map(coin => {
                                const conditions = shortConditionsMap[coin];
                                const conditionCount = conditions.length;
                                return `${coin}<span class="coin-frequency">Ã—${conditionCount}</span>`;
                            }).join(', ');
                            document.getElementById('short-pool-list').innerHTML = shortPoolHtml;
                        } else {
                            document.getElementById('short-pool-list').textContent = 'æš‚æ— ç¬¦åˆæ¡ä»¶çš„å¸ç§';
                        }

                        // åšç©ºå¸ç§æ± è¯¦æƒ… - åªæœ‰æ€¥è·Œ
                        const onlyRushDownSorted = onlyRushDown.sort((a, b) => {
                            return (frequencyMap[b] || 0) - (frequencyMap[a] || 0);
                        });
                        document.getElementById('only-rush-down-count').textContent = onlyRushDownSorted.length + 'ä¸ª';
                        document.getElementById('only-rush-down-coins').textContent = onlyRushDownSorted.length > 0 ? 
                            onlyRushDownSorted.map(coin => `${coin}(${frequencyMap[coin] || 1})`).join(', ') : '-';

                        // åšç©ºå¸ç§æ± è¯¦æƒ… - æ€¥è·Œ>æ€¥æ¶¨
                        const rushDownGtUpSorted = rushDownGtUp.sort((a, b) => {
                            return (frequencyMap[b] || 0) - (frequencyMap[a] || 0);
                        });
                        document.getElementById('rush-down-gt-up-count').textContent = rushDownGtUpSorted.length + 'ä¸ª';
                        document.getElementById('rush-down-gt-up-coins').textContent = rushDownGtUpSorted.length > 0 ? 
                            rushDownGtUpSorted.map(coin => `${coin}(${frequencyMap[coin] || 1})`).join(', ') : '-';

                        // åšç©ºå¸ç§æ± è¯¦æƒ… - V1å’ŒV2ï¼ˆå¤ç”¨ç›¸åŒæ•°æ®ï¼‰
                        document.getElementById('short-v1-count').textContent = v1Coins.length + 'ä¸ª';
                        document.getElementById('short-v1-coins').textContent = v1Coins.length > 0 ? formatCoinsWithCount(v1Coins) : '-';
                        
                        document.getElementById('short-v2-count').textContent = v2Coins.length + 'ä¸ª';
                        document.getElementById('short-v2-coins').textContent = v2Coins.length > 0 ? formatCoinsWithCount(v2Coins) : '-';

                        // æ›´æ–°æ—¶é—´
                        document.getElementById('update-time').textContent = 'æœ€åæ›´æ–°: ' + data.update_time;
                        document.getElementById('update-time-short').textContent = 'æœ€åæ›´æ–°: ' + data.update_time;

                        // æ˜¾ç¤ºå†…å®¹
                        document.getElementById('loading').style.display = 'none';
                        document.getElementById('content').style.display = 'block';
                    }
                })
                .catch(err => {
                    console.error('åŠ è½½æ•°æ®å¤±è´¥:', err);
                    document.getElementById('loading').textContent = 'åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•';
                });

            // åŠ è½½å¼€ä»“é€»è¾‘æ•°æ®ï¼ˆä¸‰å¤§è¶‹åŠ¿ï¼‰
            fetch('/api/opening-logic/suggestion')
                .then(res => res.json())
                .then(response => {
                    if (response.success && response.data) {
                        const data = response.data;
                        
                        // å¤§è¶‹åŠ¿æ•°æ®
                        const trendScore = data.trend_score || 0;
                        const trendText = data.trend || '-';
                        let trendColor = '#10b981'; // é»˜è®¤ç»¿è‰²
                        if (trendScore >= 10) trendColor = '#22c55e';
                        else if (trendScore >= 5) trendColor = '#10b981';
                        else if (trendScore >= 2) trendColor = '#84cc16';
                        else if (trendScore <= -10) trendColor = '#ef4444';
                        else if (trendScore <= -5) trendColor = '#f87171';
                        else if (trendScore <= -2) trendColor = '#fb923c';
                        else trendColor = '#fbbf24';
                        
                        document.getElementById('macro-trend-score').textContent = trendScore > 0 ? '+' + trendScore : trendScore;
                        document.getElementById('macro-trend-score').style.color = trendColor;
                        document.getElementById('macro-trend-text').textContent = trendText;
                        document.getElementById('macro-trend-text').style.color = trendColor;
                        
                        // æ˜¾ç¤ºå¾—åˆ†å› å­è¯¦æƒ…
                        if (data.raw_data) {
                            const raw = data.raw_data;
                            let factorsHtml = '';
                            if (raw.star_data) {
                                const starDiff = raw.star_data.solid_stars - raw.star_data.hollow_stars;
                                factorsHtml += `â€¢ æ˜Ÿæ˜Ÿå·®å€¼: ${starDiff > 0 ? '+' : ''}${starDiff}<br>`;
                            }
                            if (raw.btc_eth_change) {
                                factorsHtml += `â€¢ BTC: ${raw.btc_eth_change.BTC >= 0 ? '+' : ''}${raw.btc_eth_change.BTC.toFixed(2)}%<br>`;
                                factorsHtml += `â€¢ ETH: ${raw.btc_eth_change.ETH >= 0 ? '+' : ''}${raw.btc_eth_change.ETH.toFixed(2)}%`;
                            }
                            if (factorsHtml) {
                                document.getElementById('macro-factors').innerHTML = factorsHtml;
                            }
                        }
                        
                        // ä¸­è¶‹åŠ¿æ•°æ®ï¼ˆé™åˆ¶æ¡ä»¶ï¼‰
                        const restrictionCount = data.restrictions ? data.restrictions.length : 0;
                        const restrictionText = restrictionCount === 0 ? 'æ— é™åˆ¶' : restrictionCount + ' æ¡é™åˆ¶';
                        const restrictionColor = restrictionCount === 0 ? '#10b981' : '#f59e0b';
                        
                        document.getElementById('medium-trend-count').textContent = restrictionCount;
                        document.getElementById('medium-trend-count').style.color = restrictionColor;
                        document.getElementById('medium-trend-text').textContent = restrictionText;
                        document.getElementById('medium-trend-text').style.color = restrictionColor;
                        
                        // æ˜¾ç¤ºåšå¤šåšç©ºæƒé™
                        const canLong = data.can_long !== undefined ? data.can_long : true;
                        const canShort = data.can_short !== undefined ? data.can_short : true;
                        
                        document.getElementById('can-long-status').textContent = canLong ? 'âœ… å…è®¸' : 'ğŸš« ç¦æ­¢';
                        document.getElementById('can-long-status').style.color = canLong ? '#10b981' : '#ef4444';
                        
                        document.getElementById('can-short-status').textContent = canShort ? 'âœ… å…è®¸' : 'ğŸš« ç¦æ­¢';
                        document.getElementById('can-short-status').style.color = canShort ? '#10b981' : '#ef4444';
                        
                        // å°è¶‹åŠ¿æ•°æ®ï¼ˆå»ºè®®ä»“ä½ï¼‰
                        if (data.position_info) {
                            const positionPercent = data.position_info.position_percent || 0;
                            const positionLevel = data.position_info.position_level || '-';
                            const positionType = data.position_info.position_type || 'neutral';
                            const starPosition = data.position_info.star_position || 0;
                            const oiPosition = data.position_info.oi_position || 0;
                            
                            let positionColor = '#10b981';
                            if (positionType === 'long') positionColor = '#10b981';
                            else if (positionType === 'short') positionColor = '#ef4444';
                            else positionColor = '#fbbf24';
                            
                            document.getElementById('small-trend-position').textContent = positionPercent + '%';
                            document.getElementById('small-trend-position').style.color = positionColor;
                            document.getElementById('small-trend-text').textContent = positionLevel;
                            document.getElementById('small-trend-text').style.color = positionColor;
                            
                            // æ˜¾ç¤ºä»“ä½ç»†åˆ†
                            document.getElementById('star-position').textContent = starPosition + '%';
                            document.getElementById('star-position').style.color = positionColor;
                            document.getElementById('oi-position').textContent = oiPosition + '%';
                            document.getElementById('oi-position').style.color = positionColor;
                        }
                    }
                })
                .catch(err => {
                    console.error('è·å–å¼€ä»“é€»è¾‘æ•°æ®å¤±è´¥:', err);
                });
        }

        // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
        loadData();

        // æ¯60ç§’åˆ·æ–°ä¸€æ¬¡
        setInterval(loadData, 60000);
    </script>
</body>
</html>
