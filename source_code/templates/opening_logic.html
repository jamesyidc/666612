<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>å¼€ä»“é€»è¾‘ç³»ç»Ÿ - åŠ å¯†è´§å¸äº¤æ˜“è¾…åŠ© v2.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 36px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        /* ä¸»å¡ç‰‡å®¹å™¨ */
        .main-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        /* ç‹¬ç«‹çš„å¤§åŒºå— */
        .major-section {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 3px solid #667eea;
        }

        .medium-section {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 3px solid #e17055;
        }

        .section-header {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            padding: 15px;
            border-radius: 10px;
        }

        .major-section .section-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .medium-section .section-header {
            background: linear-gradient(135deg, #e17055 0%, #d63031 100%);
            color: white;
        }

        /* è¶‹åŠ¿å¾—åˆ†åŒºåŸŸ */
        .trend-score-area {
            text-align: center;
            margin: 30px 0;
            padding: 30px;
            background: white;
            border-radius: 15px;
        }

        .trend-score {
            font-size: 72px;
            font-weight: bold;
            margin: 20px 0;
        }

        .trend-label {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        /* å¼€ä»“å»ºè®®æ¡† */
        .suggestion-box {
            padding: 30px;
            border-radius: 15px;
            font-size: 28px;
            font-weight: bold;
            text-align: center;
            margin: 30px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .suggestion-long {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }

        .suggestion-short {
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
            color: white;
        }

        .suggestion-neutral {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .suggestion-restricted {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }

        /* å¾—åˆ†è¯¦æƒ…å¡ç‰‡ */
        .score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .score-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border: 3px solid #e0e0e0;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .score-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        .score-card.positive {
            border-color: #28a745;
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
        }

        .score-card.negative {
            border-color: #dc3545;
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
        }

        .score-card h4 {
            font-size: 18px;
            margin-bottom: 12px;
            color: #333;
            font-weight: 700;
            text-align: center;
            padding-bottom: 8px;
            border-bottom: 2px solid rgba(0,0,0,0.1);
        }

        .score-card .level {
            font-size: 18px;
            font-weight: bold;
            margin: 12px 0;
            color: #495057;
            text-align: center;
            padding: 8px;
            background: rgba(255,255,255,0.7);
            border-radius: 6px;
        }

        .score-card .value {
            font-size: 16px;
            color: #333;
            margin: 12px 0;
            text-align: center;
        }

        .score-card .points {
            font-size: 52px;
            font-weight: 900;
            margin-top: 12px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .score-card.positive .points {
            color: #28a745;
        }

        .score-card.negative .points {
            color: #dc3545;
        }

        /* é™åˆ¶æ¡ä»¶åˆ—è¡¨ */
        .restrictions-box {
            background: #fff3cd;
            border: 3px solid #ffc107;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
        }

        .restrictions-box.safe {
            background: #d4edda;
            border-color: #28a745;
        }

        .restrictions-box h4 {
            color: #856404;
            margin-bottom: 15px;
            font-size: 20px;
            font-weight: bold;
        }

        .restrictions-box.safe h4 {
            color: #155724;
        }

        .restrictions-box ul {
            list-style: none;
        }

        .restrictions-box li {
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            font-size: 15px;
        }

        .restrictions-box.safe li {
            border-left-color: #28a745;
        }

        /* åŸå§‹æ•°æ®ç½‘æ ¼ */
        .raw-data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .raw-data-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .raw-data-item .label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .raw-data-item .value {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }

        /* å¤šç©ºçŠ¶æ€ */
        .status-row {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            flex-wrap: wrap;
            gap: 20px;
        }

        .status-item {
            flex: 1;
            min-width: 200px;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .status-allowed {
            background: #d4edda;
            border: 3px solid #28a745;
        }

        .status-forbidden {
            background: #f8d7da;
            border: 3px solid #dc3545;
        }

        .status-item h3 {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .status-item .status-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        /* åˆ·æ–°æŒ‰é’® */
        .refresh-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s;
            margin: 20px 0;
        }

        .refresh-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(0,0,0,0.3);
        }

        .timestamp {
            text-align: center;
            color: #666;
            margin: 20px 0;
            font-size: 14px;
        }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 24px;
            color: #667eea;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        .home-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: all 0.3s;
            z-index: 1000;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .home-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }
    </style>
</head>
<body>
    <a href="/" class="home-btn">
        ğŸ  è¿”å›é¦–é¡µ
    </a>
    
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ å¼€ä»“é€»è¾‘ç³»ç»Ÿ</h1>
            <p>åŸºäºå¤šç»´åº¦å› å­çš„æ™ºèƒ½äº¤æ˜“è¾…åŠ©å†³ç­–ç³»ç»Ÿ</p>
        </div>

        <div class="main-card">
            <div style="text-align: center;">
                <button class="refresh-btn" onclick="loadData()">ğŸ”„ åˆ·æ–°æ•°æ®</button>
            </div>

            <div id="content" class="loading">
                <div class="spinner"></div>
                <p>æ­£åœ¨åŠ è½½æ•°æ®...</p>
            </div>
        </div>
    </div>

    <script>
        async function loadData() {
            const contentEl = document.getElementById('content');
            contentEl.innerHTML = '<div class="spinner"></div><p class="loading">æ­£åœ¨è®¡ç®—...</p>';

            try {
                // æ·»åŠ æ—¶é—´æˆ³é˜²æ­¢ç¼“å­˜
                const timestamp = new Date().getTime();
                const response = await fetch(`/api/opening-logic/suggestion?_t=${timestamp}`);
                const result = await response.json();

                if (result.success) {
                    renderData(result.data);
                } else {
                    contentEl.innerHTML = `<p style="color: red; text-align: center;">âŒ åŠ è½½å¤±è´¥: ${result.error}</p>`;
                }
            } catch (error) {
                contentEl.innerHTML = `<p style="color: red; text-align: center;">âŒ ç½‘ç»œé”™è¯¯: ${error.message}</p>`;
            }
        }

        function renderData(data) {
            const suggestionClass = {
                'long': 'suggestion-long',
                'short': 'suggestion-short',
                'neutral': 'suggestion-neutral',
                'restricted': 'suggestion-restricted'
            }[data.suggestion_type];

            let html = `
                <!-- ========== ç¬¬ä¸€éƒ¨åˆ†ï¼šå¤§è¶‹åŠ¿åˆ¤æ–­ ========== -->
                <div class="major-section">
                    <div class="section-header">ğŸ“ˆ å¤§è¶‹åŠ¿åˆ¤æ–­ï¼ˆMacro Trendï¼‰</div>
                    
                    <!-- è¶‹åŠ¿å¾—åˆ† -->
                    <div class="trend-score-area">
                        <div class="trend-label">å½“å‰è¶‹åŠ¿å¾—åˆ†</div>
                        <div class="trend-score" style="color: ${data.color}">${data.trend_score > 0 ? '+' : ''}${data.trend_score}</div>
                        <div class="trend-label" style="color: ${data.color}">${data.trend}</div>
                    </div>

                    <!-- å¾—åˆ†è¯¦æƒ… -->
                    <h3 style="margin: 25px 0 15px 0; color: #333; font-size: 20px;">ğŸ“Š å¾—åˆ†æ„æˆè¯¦æƒ…</h3>
                    <div class="score-grid">
            `;

            // å¾—åˆ†å¡ç‰‡
            if (data.score_details && data.score_details.length > 0) {
                data.score_details.forEach(item => {
                    const cardClass = item.score > 0 ? 'positive' : (item.score < 0 ? 'negative' : '');
                    html += `
                        <div class="score-card ${cardClass}">
                            <h4>${item.factor}</h4>
                            <div class="level">${item.level}</div>
                            <div class="value" style="font-size: 20px; font-weight: bold; margin: 10px 0;">
                                å½“å‰: <span style="color: ${item.score > 0 ? '#28a745' : '#dc3545'};">${item.value}</span>
                            </div>
                            <div style="border-top: 2px dashed ${item.score > 0 ? '#28a745' : '#dc3545'}; margin: 10px 0; opacity: 0.3;"></div>
                            <div class="points" style="font-size: 48px;">${item.score > 0 ? '+' : ''}${item.score} åˆ†</div>
                        </div>
                    `;
                });
            }

            html += `
                    </div>

                    <!-- å¤§è¶‹åŠ¿è¯„åˆ†è§„åˆ™è¯´æ˜ -->
                    <div style="background: white; padding: 25px; border-radius: 10px; margin-top: 25px; border: 2px solid #667eea;">
                        <h4 style="color: #333; margin-bottom: 15px; font-size: 20px; text-align: center;">ğŸ“‹ å¤§è¶‹åŠ¿è¯„åˆ†è§„åˆ™è¯´æ˜</h4>
                        <p style="text-align: center; color: #666; margin-bottom: 20px; font-size: 14px;">
                            ä»¥ä¸‹è§„åˆ™ä¼šæ ¹æ®å½“å‰å¸‚åœºæ•°æ®è‡ªåŠ¨è®¡ç®—å¾—åˆ†ï¼Œå¹¶åœ¨ä¸Šæ–¹çš„å¾—åˆ†å¡ç‰‡ä¸­æ˜¾ç¤º
                        </p>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; font-size: 14px;">
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #28a745;">
                                <strong style="color: #28a745;">â­ æ˜Ÿæ˜Ÿå·®å€¼è¯„åˆ†ï¼ˆåšå¤šï¼‰</strong><br>
                                å®å¿ƒæ˜Ÿ-ç©ºå¿ƒæ˜Ÿ â‰¥ 10 â†’ <strong>+5åˆ†</strong><br>
                                å®å¿ƒæ˜Ÿ-ç©ºå¿ƒæ˜Ÿ â‰¥ 5 â†’ <strong>+2åˆ†</strong><br>
                                å®å¿ƒæ˜Ÿ-ç©ºå¿ƒæ˜Ÿ â‰¥ 3 â†’ <strong>+1åˆ†</strong>
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #dc3545;">
                                <strong style="color: #dc3545;">â˜† æ˜Ÿæ˜Ÿå·®å€¼è¯„åˆ†ï¼ˆåšç©ºï¼‰</strong><br>
                                ç©ºå¿ƒæ˜Ÿ-å®å¿ƒæ˜Ÿ â‰¥ 10 â†’ <strong>-5åˆ†</strong><br>
                                ç©ºå¿ƒæ˜Ÿ-å®å¿ƒæ˜Ÿ â‰¥ 5 â†’ <strong>-2åˆ†</strong><br>
                                ç©ºå¿ƒæ˜Ÿ-å®å¿ƒæ˜Ÿ â‰¥ 3 â†’ <strong>-1åˆ†</strong>
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #28a745;">
                                <strong style="color: #28a745;">â‚¿ BTCæ¶¨å¹…è¯„åˆ†</strong><br>
                                BTCæ¶¨å¹… â‰¥ 3% â†’ <strong>+5åˆ†</strong><br>
                                BTCæ¶¨å¹… â‰¥ 2% â†’ <strong>+2åˆ†</strong><br>
                                BTCæ¶¨å¹… â‰¥ 1% â†’ <strong>+1åˆ†</strong>
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #dc3545;">
                                <strong style="color: #dc3545;">â‚¿ BTCè·Œå¹…è¯„åˆ†</strong><br>
                                BTCè·Œå¹… â‰¤ -3% â†’ <strong>-5åˆ†</strong><br>
                                BTCè·Œå¹… â‰¤ -2% â†’ <strong>-2åˆ†</strong><br>
                                BTCè·Œå¹… â‰¤ -1% â†’ <strong>-1åˆ†</strong>
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #28a745;">
                                <strong style="color: #28a745;">Î ETHæ¶¨å¹…è¯„åˆ†</strong><br>
                                ETHæ¶¨å¹… â‰¥ 3% â†’ <strong>+5åˆ†</strong><br>
                                ETHæ¶¨å¹… â‰¥ 2% â†’ <strong>+2åˆ†</strong><br>
                                ETHæ¶¨å¹… â‰¥ 1% â†’ <strong>+1åˆ†</strong>
                            </div>
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #dc3545;">
                                <strong style="color: #dc3545;">Î ETHè·Œå¹…è¯„åˆ†</strong><br>
                                ETHè·Œå¹… â‰¤ -3% â†’ <strong>-5åˆ†</strong><br>
                                ETHè·Œå¹… â‰¤ -2% â†’ <strong>-2åˆ†</strong><br>
                                ETHè·Œå¹… â‰¤ -1% â†’ <strong>-1åˆ†</strong>
                            </div>
                        </div>
                        <div style="margin-top: 15px; padding: 12px; background: #e7f3ff; border-radius: 5px; border-left: 4px solid #007bff;">
                            <strong>ğŸ’¡ å¾—åˆ†è¯´æ˜ï¼š</strong>
                            â€¢ å¾—åˆ† â‰¥ 10ï¼šå¾ˆå¼ºåšå¤š | å¾—åˆ† â‰¥ 5ï¼šè¾ƒå¼ºåšå¤š | å¾—åˆ† â‰¥ 2ï¼šåå¼ºåšå¤š<br>
                            â€¢ å¾—åˆ† â‰¤ -10ï¼šå¾ˆå¼ºåšç©º | å¾—åˆ† â‰¤ -5ï¼šè¾ƒå¼ºåšç©º | å¾—åˆ† â‰¤ -2ï¼šåå¼ºåšç©º<br>
                            â€¢ -1 < å¾—åˆ† < 2ï¼šéœ‡è¡è§‚æœ›
                        </div>
                    </div>
                </div>

                <!-- ========== ç¬¬äºŒéƒ¨åˆ†ï¼šä¸­è¶‹åŠ¿é™åˆ¶æ¡ä»¶ ========== -->
                <div class="medium-section">
                    <div class="section-header">âš ï¸ ä¸­è¶‹åŠ¿é™åˆ¶æ¡ä»¶ï¼ˆTrend Restrictionsï¼‰</div>
            `;

            // è§¦å‘çš„é™åˆ¶æ¡ä»¶
            if (data.restrictions && data.restrictions.length > 0) {
                html += `
                    <div class="restrictions-box">
                        <h4>ğŸš« å·²è§¦å‘çš„é™åˆ¶æ¡ä»¶ï¼ˆå…± ${data.restrictions.length} æ¡ï¼‰</h4>
                        <ul>
                `;
                data.restrictions.forEach(reason => {
                    html += `<li>ğŸ”¸ ${reason}</li>`;
                });
                html += `
                        </ul>
                    </div>
                `;
            } else {
                html += `
                    <div class="restrictions-box safe">
                        <h4>âœ… å½“å‰æ— é™åˆ¶æ¡ä»¶è§¦å‘</h4>
                        <p style="color: #155724; margin-top: 10px; font-size: 15px;">æ‰€æœ‰13ä¸ªé™åˆ¶å› å­å‡æœªè¾¾åˆ°é™åˆ¶é˜ˆå€¼ï¼Œå¯ä»¥æ­£å¸¸äº¤æ˜“</p>
                    </div>
                `;
            }

            // é™åˆ¶æ¡ä»¶è§„åˆ™è¯´æ˜
            html += `
                    <div style="background: white; padding: 20px; border-radius: 10px; margin-top: 20px;">
                        <h4 style="color: #333; margin-bottom: 15px;">ğŸ“‹ é™åˆ¶æ¡ä»¶è¯¦ç»†è§„åˆ™ï¼ˆ13ä¸ªå› å­ï¼‰</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; font-size: 14px;">
                            <div style="padding: 12px; background: #f8f9fa; border-radius: 6px;">
                                <strong style="color: #dc3545;">ğŸš« BTCæ¶¨å¹…é™åˆ¶</strong><br>
                                BTCæ¶¨å¹… â‰¥ 3% â†’ <strong>ä¸åšç©º</strong><br>
                                BTCæ¶¨å¹… â‰¥ 2% â†’ <strong>ä¸åšç©º</strong>
                            </div>
                            <div style="padding: 12px; background: #f8f9fa; border-radius: 6px;">
                                <strong style="color: #dc3545;">ğŸš« BTCè·Œå¹…é™åˆ¶</strong><br>
                                BTCè·Œå¹… â‰¤ -3% â†’ <strong>ä¸åšå¤š</strong><br>
                                BTCè·Œå¹… â‰¤ -2% â†’ <strong>ä¸åšå¤š</strong>
                            </div>
                            <div style="padding: 12px; background: #f8f9fa; border-radius: 6px;">
                                <strong style="color: #dc3545;">ğŸš« ETHæ¶¨å¹…é™åˆ¶</strong><br>
                                ETHæ¶¨å¹… â‰¥ 3% â†’ <strong>ä¸åšç©º</strong><br>
                                ETHæ¶¨å¹… â‰¥ 2% â†’ <strong>ä¸åšç©º</strong>
                            </div>
                            <div style="padding: 12px; background: #f8f9fa; border-radius: 6px;">
                                <strong style="color: #dc3545;">ğŸš« ETHè·Œå¹…é™åˆ¶</strong><br>
                                ETHè·Œå¹… â‰¤ -3% â†’ <strong>ä¸åšå¤š</strong><br>
                                ETHè·Œå¹… â‰¤ -2% â†’ <strong>ä¸åšå¤š</strong>
                            </div>
                            <div style="padding: 12px; background: #f8f9fa; border-radius: 6px;">
                                <strong style="color: #dc3545;">ğŸš« åˆ›æ–°é«˜/ä½é™åˆ¶</strong><br>
                                åˆ›æ–°é«˜æ¬¡æ•° â‰¥ 3 â†’ <strong>ä¸åšç©º</strong><br>
                                åˆ›æ–°ä½æ¬¡æ•° â‰¥ 3 â†’ <strong>ä¸åšå¤š</strong>
                            </div>
                            <div style="padding: 12px; background: #f8f9fa; border-radius: 6px;">
                                <strong style="color: #dc3545;">ğŸš« æ˜Ÿæ˜Ÿæ•°é‡é™åˆ¶</strong><br>
                                ç©ºå¿ƒæ˜Ÿæ˜Ÿ â‰¥ 3ä¸ª â†’ <strong>ä¸åšå¤š</strong><br>
                                å®å¿ƒæ˜Ÿæ˜Ÿ â‰¥ 3ä¸ª â†’ <strong>ä¸åšç©º</strong>
                            </div>
                            <div style="padding: 12px; background: #f8f9fa; border-radius: 6px;">
                                <strong style="color: #dc3545;">ğŸš« æ€¥æ¶¨æ€¥è·Œé™åˆ¶</strong><br>
                                æ€¥æ¶¨-æ€¥è·Œ â‰¥ 20 â†’ <strong>ä¸åšç©º</strong><br>
                                æ€¥æ¶¨-æ€¥è·Œ â‰¤ -20 â†’ <strong>ä¸åšå¤š</strong>
                            </div>
                            <div style="padding: 12px; background: #f8f9fa; border-radius: 6px;">
                                <strong style="color: #dc3545;">ğŸš« æç«¯æ¶¨è·Œé™åˆ¶</strong><br>
                                24hæ¶¨â‰¥10%å¸ç§æ•° â‰¥ 2 â†’ <strong>ä¸åšç©º</strong><br>
                                24hè·Œâ‰¤-10%å¸ç§æ•° â‰¥ 2 â†’ <strong>ä¸åšå¤š</strong>
                            </div>
                        </div>
                        <div style="margin-top: 15px; padding: 12px; background: #fff3cd; border-radius: 5px; border-left: 4px solid #ffc107;">
                            <strong>ğŸ’¡ é™åˆ¶æ¡ä»¶è¯´æ˜ï¼š</strong>
                            é™åˆ¶æ¡ä»¶ç”¨äºé˜²æ­¢åœ¨æç«¯å¸‚åœºæƒ…å†µä¸‹é€†åŠ¿æ“ä½œï¼Œå³ä½¿å¤§è¶‹åŠ¿å¾—åˆ†å¾ˆé«˜ï¼Œè§¦å‘ä»»ä¸€é™åˆ¶æ¡ä»¶ä¹Ÿä¼šè½¬ä¸ºè§‚æœ›å»ºè®®
                        </div>
                    </div>

                    <!-- å¤šç©ºçŠ¶æ€ -->
                    <h3 style="margin: 25px 0 15px 0; color: #333; font-size: 20px;">ğŸ¯ å½“å‰äº¤æ˜“æƒé™çŠ¶æ€</h3>
                    <div class="status-row">
                        <div class="status-item ${data.can_long ? 'status-allowed' : 'status-forbidden'}">
                            <div class="status-icon">${data.can_long ? 'âœ…' : 'ğŸš«'}</div>
                            <h3>åšå¤šæƒé™</h3>
                            <p style="font-size: 16px; font-weight: bold;">${data.can_long ? 'âœ… å…è®¸åšå¤š' : 'ğŸš« ç¦æ­¢åšå¤š'}</p>
                        </div>
                        <div class="status-item ${data.can_short ? 'status-allowed' : 'status-forbidden'}">
                            <div class="status-icon">${data.can_short ? 'âœ…' : 'ğŸš«'}</div>
                            <h3>åšç©ºæƒé™</h3>
                            <p style="font-size: 16px; font-weight: bold;">${data.can_short ? 'âœ… å…è®¸åšç©º' : 'ğŸš« ç¦æ­¢åšç©º'}</p>
                        </div>
                    </div>
                </div>

                <!-- ========== ç¬¬ä¸‰éƒ¨åˆ†ï¼šæœ€ç»ˆå»ºè®® ========== -->
                <div style="background: white; border-radius: 15px; padding: 30px; margin-bottom: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                    <h3 style="text-align: center; margin-bottom: 20px; font-size: 24px; color: #333;">ğŸ¯ ç»¼åˆå¼€ä»“å»ºè®®</h3>
                    <div class="suggestion-box ${suggestionClass}">
                        ${data.suggestion}
                    </div>
                    <p style="text-align: center; color: #666; font-size: 14px; margin-top: 15px;">
                        å»ºè®®åŸºäºå¤§è¶‹åŠ¿å¾—åˆ†å’Œä¸­è¶‹åŠ¿é™åˆ¶æ¡ä»¶ç»¼åˆåˆ¤æ–­å¾—å‡º
                    </p>
                </div>

                <!-- ========== ç¬¬3.5éƒ¨åˆ†ï¼šå»ºè®®ä»“ä½ ========== -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; padding: 30px; margin-bottom: 30px; box-shadow: 0 8px 20px rgba(102,126,234,0.3); color: white;">
                    <h3 style="text-align: center; margin-bottom: 25px; font-size: 24px; color: white; text-shadow: 2px 2px 4px rgba(0,0,0,0.2);">
                        ğŸ’° å»ºè®®ä»“ä½
                    </h3>
            `;

            const pos = data.position_info;
            const positionColor = pos.position_type === 'long' ? '#4ade80' : 
                                 pos.position_type === 'short' ? '#f87171' : '#fbbf24';
            const positionIcon = pos.position_type === 'long' ? 'ğŸ“ˆ' : 
                                pos.position_type === 'short' ? 'ğŸ“‰' : 'â¸ï¸';
            
            // æ ¼å¼åŒ–é¦–æ¬¡å‡ºç°æ—¶é—´
            const firstAppearedTime = pos.first_appeared_at ? new Date(pos.first_appeared_at).toLocaleString('zh-CN', {
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            }) : '';
            
            // å¼€ä»“æ–¹å‘æ–‡æœ¬
            let directionText = '';
            let directionColor = '';
            if (pos.position_type === 'long') {
                directionText = 'ğŸ“ˆ å¼€å¤šå•';
                directionColor = '#4ade80';
            } else if (pos.position_type === 'short') {
                directionText = 'ğŸ“‰ å¼€ç©ºå•';
                directionColor = '#f87171';
            } else {
                directionText = 'â¸ï¸ è§‚æœ›';
                directionColor = '#fbbf24';
            }
            
            html += `
                    <!-- ä»“ä½ç™¾åˆ†æ¯”æ˜¾ç¤º -->
                    <div style="text-align: center; margin-bottom: 25px;">
                        <div style="background: rgba(255,255,255,0.95); border-radius: 20px; padding: 35px; display: inline-block; min-width: 400px; box-shadow: 0 5px 20px rgba(0,0,0,0.2);">
                            
                            <!-- å¼€ä»“æ–¹å‘ - é†’ç›®æ˜¾ç¤º -->
                            <div style="background: linear-gradient(135deg, ${directionColor}22, ${directionColor}44); 
                                        border: 3px solid ${directionColor}; 
                                        border-radius: 15px; 
                                        padding: 15px 25px; 
                                        margin-bottom: 20px;
                                        font-size: 28px; 
                                        font-weight: 900; 
                                        color: ${directionColor};
                                        text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
                                        box-shadow: 0 3px 10px ${directionColor}33;">
                                ${directionText}
                            </div>
                            
                            <!-- ä»“ä½ç­‰çº§å’Œç™¾åˆ†æ¯” -->
                            <div style="font-size: 18px; color: #666; margin-bottom: 10px; font-weight: 600;">
                                ${positionIcon} ${pos.position_level}
                            </div>
                            <div style="font-size: 72px; font-weight: 900; color: ${positionColor}; line-height: 1; text-shadow: 3px 3px 6px rgba(0,0,0,0.1);">
                                ${pos.position_percent}%
                            </div>
                            
                            <!-- é¦–æ¬¡å‡ºç°æ—¶é—´å’Œé¦–æ¬¡å¼€ä»“å»ºè®® -->
                            ${pos.first_appeared_at && pos.position_percent > 0 ? `
                            <div style="margin-top: 15px; padding: 12px 20px; 
                                        background: linear-gradient(135deg, #667eea22, #764ba244);
                                        border-radius: 10px; border: 2px dashed #667eea;">
                                <div style="font-size: 12px; color: #999; margin-bottom: 5px;">â±ï¸ é¦–æ¬¡å‡ºç°æ—¶é—´</div>
                                <div style="font-size: 16px; font-weight: 700; color: #667eea; margin-bottom: 10px;">${firstAppearedTime}</div>
                                <div style="font-size: 12px; color: #999; margin-bottom: 5px;">ğŸ’¡ é¦–æ¬¡å¼€ä»“å»ºè®®</div>
                                <div style="font-size: 20px; font-weight: 800; color: #764ba2;">
                                    ${pos.initial_position_percent}%
                                    <span style="font-size: 12px; color: #999; font-weight: 400;">(æ€»ä»“ä½çš„30%)</span>
                                </div>
                            </div>
                            ` : ''}
                            
                            <!-- ä»“ä½ç»†åˆ† -->
                            <div style="margin-top: 20px; padding-top: 20px; border-top: 2px dashed #e0e0e0;">
                                <div style="display: flex; justify-content: space-around; margin-bottom: 10px;">
                                    <div style="text-align: center;">
                                        <div style="font-size: 11px; color: #999; margin-bottom: 5px;">â­ æ˜Ÿæ˜Ÿä»“ä½</div>
                                        <div style="font-size: 24px; font-weight: 700; color: #667eea;">${pos.star_position}%</div>
                                    </div>
                                    <div style="font-size: 20px; color: #ddd; margin: 0 10px;">+</div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 11px; color: #999; margin-bottom: 5px;">ğŸ“Š æŒä»“é‡ä»“ä½</div>
                                        <div style="font-size: 24px; font-weight: 700; color: #764ba2;">${pos.oi_position}%</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- è®¡ç®—è¯¦æƒ… -->
                    <div style="background: rgba(255,255,255,0.15); border-radius: 12px; padding: 20px; backdrop-filter: blur(10px);">
                        <h4 style="margin: 0 0 15px 0; font-size: 16px; color: white; font-weight: 600;">
                            ğŸ“‹ ä»“ä½è®¡ç®—è¯¦æƒ…
                        </h4>
            `;

            pos.calculation_details.forEach(detail => {
                html += `
                        <div style="padding: 8px 12px; background: rgba(255,255,255,0.1); border-radius: 6px; margin-bottom: 8px; font-size: 14px; border-left: 3px solid ${positionColor};">
                            â€¢ ${detail}
                        </div>
                `;
            });

            html += `
                    </div>

                    <!-- ä»“ä½è§„åˆ™è¯´æ˜ -->
                    <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px; font-size: 13px; line-height: 1.8; backdrop-filter: blur(10px);">
                        <strong style="color: #ffd700;">ğŸ’¡ ä»“ä½è§„åˆ™è¯´æ˜ï¼š</strong><br>
                        <div style="margin-top: 10px; padding-left: 10px;">
                            <div style="margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.15);">
                                <strong style="color: #fff;">â­ æ˜Ÿæ˜Ÿä»“ä½è§„åˆ™ï¼š</strong>
                                <div style="margin-left: 10px; margin-top: 5px;">
                                    â€¢ æ— åºæ³¢åŠ¨ï¼šæ€¥æ¶¨+æ€¥è·Œ â‰¤ 10 â†’ 10%<br>
                                    â€¢ åšå¤šï¼šå®å¿ƒä¼˜åŠ¿ â‰¥3/5/10 â†’ 20%/40%/60%<br>
                                    â€¢ åšç©ºï¼šç©ºå¿ƒä¼˜åŠ¿ â‰¥3/5/10 â†’ 20%/40%/60%
                                </div>
                            </div>
                            <div style="margin-bottom: 10px;">
                                <strong style="color: #fff;">ğŸ“Š å…¨ç½‘æŒä»“é‡ä»“ä½è§„åˆ™ï¼š</strong>
                                <div style="margin-left: 10px; margin-top: 5px;">
                                    â€¢ <92äº¿ å¼ºçƒˆåšå¤š +20% | 92-95äº¿ ä¸€èˆ¬åšå¤š +10%<br>
                                    â€¢ 95-100äº¿ å¯åšå¤š +5% | 100-110äº¿ å¯åšç©º +5%<br>
                                    â€¢ 110-115äº¿ ä¸€èˆ¬åšç©º +10% | â‰¥115äº¿ å¼ºçƒˆåšç©º +20%
                                </div>
                            </div>
                            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.2); color: #ffd700;">
                                âš ï¸ æ˜Ÿæ˜Ÿä»“ä½ + æŒä»“é‡ä»“ä½ â‰¤ 70%ï¼ˆè‡ªåŠ¨æ§åˆ¶ä¸Šé™ï¼‰<br>
                                âš ï¸ ä»“ä½å»ºè®®éœ€ç»“åˆäº¤æ˜“æƒé™ï¼Œæƒé™å—é™åˆ™ä¸º0%
                            </div>
                        </div>
                    </div>
                </div>
            `;

            html += `

                <!-- ========== ç¬¬å››éƒ¨åˆ†ï¼šå®æ—¶å¸‚åœºæ•°æ® ========== -->
                <div style="background: #f8f9fa; border-radius: 15px; padding: 30px; border: 2px solid #dee2e6;">
                    <h3 style="margin-bottom: 15px; font-size: 22px; color: #333; text-align: center;">ğŸ“ˆ å®æ—¶å¸‚åœºåŸå§‹æ•°æ®</h3>
                    <p style="text-align: center; color: #666; margin-bottom: 20px; font-size: 14px;">
                        è¿™äº›æ•°æ®ç”¨äºè®¡ç®—ä¸Šæ–¹çš„è¶‹åŠ¿å¾—åˆ†å’Œé™åˆ¶æ¡ä»¶åˆ¤æ–­
                    </p>
                    <div class="raw-data-grid">
            `;

            const raw = data.raw_data;
            
            // æ˜Ÿæ˜Ÿæ•°æ®
            html += `
                        <div class="raw-data-item">
                            <div class="label">â­ å®å¿ƒæ˜Ÿæ˜Ÿ</div>
                            <div class="value" style="color: #28a745;">${raw.star_data.solid_stars}</div>
                        </div>
                        <div class="raw-data-item">
                            <div class="label">â˜† ç©ºå¿ƒæ˜Ÿæ˜Ÿ</div>
                            <div class="value" style="color: #dc3545;">${raw.star_data.hollow_stars}</div>
                        </div>
                        <div class="raw-data-item">
                            <div class="label">ğŸš€ æ€¥æ¶¨å¸ç§</div>
                            <div class="value" style="color: #28a745;">${raw.star_data.rush_up}</div>
                        </div>
                        <div class="raw-data-item">
                            <div class="label">ğŸ“‰ æ€¥è·Œå¸ç§</div>
                            <div class="value" style="color: #dc3545;">${raw.star_data.rush_down}</div>
                        </div>
            `;

            // BTC/ETHæ¶¨è·Œå¹…ï¼ˆç‰¹åˆ«çªå‡ºæ˜¾ç¤ºï¼‰
            const btcColor = raw.btc_eth_change.BTC >= 0 ? '#28a745' : '#dc3545';
            const ethColor = raw.btc_eth_change.ETH >= 0 ? '#28a745' : '#dc3545';
            
            // è®¡ç®—BTCå¾—åˆ†è¯´æ˜
            let btcScoreText = '';
            if (raw.btc_eth_change.BTC >= 3) btcScoreText = 'â†’ +5åˆ† (æ¶¨å¹…â‰¥3%)';
            else if (raw.btc_eth_change.BTC >= 2) btcScoreText = 'â†’ +2åˆ† (æ¶¨å¹…â‰¥2%)';
            else if (raw.btc_eth_change.BTC >= 1) btcScoreText = 'â†’ +1åˆ† (æ¶¨å¹…â‰¥1%)';
            else if (raw.btc_eth_change.BTC <= -3) btcScoreText = 'â†’ -5åˆ† (è·Œå¹…â‰¤-3%)';
            else if (raw.btc_eth_change.BTC <= -2) btcScoreText = 'â†’ -2åˆ† (è·Œå¹…â‰¤-2%)';
            else if (raw.btc_eth_change.BTC <= -1) btcScoreText = 'â†’ -1åˆ† (è·Œå¹…â‰¤-1%)';
            else btcScoreText = 'â†’ 0åˆ† (æ¶¨è·Œå¹…<1%)';
            
            // è®¡ç®—ETHå¾—åˆ†è¯´æ˜
            let ethScoreText = '';
            if (raw.btc_eth_change.ETH >= 3) ethScoreText = 'â†’ +5åˆ† (æ¶¨å¹…â‰¥3%)';
            else if (raw.btc_eth_change.ETH >= 2) ethScoreText = 'â†’ +2åˆ† (æ¶¨å¹…â‰¥2%)';
            else if (raw.btc_eth_change.ETH >= 1) ethScoreText = 'â†’ +1åˆ† (æ¶¨å¹…â‰¥1%)';
            else if (raw.btc_eth_change.ETH <= -3) ethScoreText = 'â†’ -5åˆ† (è·Œå¹…â‰¤-3%)';
            else if (raw.btc_eth_change.ETH <= -2) ethScoreText = 'â†’ -2åˆ† (è·Œå¹…â‰¤-2%)';
            else if (raw.btc_eth_change.ETH <= -1) ethScoreText = 'â†’ -1åˆ† (è·Œå¹…â‰¤-1%)';
            else ethScoreText = 'â†’ 0åˆ† (æ¶¨è·Œå¹…<1%)';
            
            html += `
                        <div class="raw-data-item" style="border: 3px solid ${btcColor}; background: linear-gradient(135deg, ${btcColor}15 0%, ${btcColor}08 100%);">
                            <div class="label" style="font-weight: 700; font-size: 14px;">â‚¿ BTC 24hæ¶¨è·Œï¼ˆOKExæ°¸ç»­ï¼‰</div>
                            <div class="value" style="color: ${btcColor}; font-size: 28px; margin-bottom: 5px;">${raw.btc_eth_change.BTC >= 0 ? '+' : ''}${raw.btc_eth_change.BTC.toFixed(2)}%</div>
                            <div style="font-size: 12px; color: #666; font-weight: 600;">${btcScoreText}</div>
                        </div>
                        <div class="raw-data-item" style="border: 3px solid ${ethColor}; background: linear-gradient(135deg, ${ethColor}15 0%, ${ethColor}08 100%);">
                            <div class="label" style="font-weight: 700; font-size: 14px;">Î ETH 24hæ¶¨è·Œï¼ˆOKExæ°¸ç»­ï¼‰</div>
                            <div class="value" style="color: ${ethColor}; font-size: 28px; margin-bottom: 5px;">${raw.btc_eth_change.ETH >= 0 ? '+' : ''}${raw.btc_eth_change.ETH.toFixed(2)}%</div>
                            <div style="font-size: 12px; color: #666; font-weight: 600;">${ethScoreText}</div>
                        </div>
            `;

            // åˆ›æ–°é«˜/åˆ›æ–°ä½
            html += `
                        <div class="raw-data-item">
                            <div class="label">ğŸ“ˆ ä»Šæ—¥åˆ›æ–°é«˜</div>
                            <div class="value" style="color: #28a745;">${raw.breakthrough.new_high_count}</div>
                        </div>
                        <div class="raw-data-item">
                            <div class="label">ğŸ“‰ ä»Šæ—¥åˆ›æ–°ä½</div>
                            <div class="value" style="color: #dc3545;">${raw.breakthrough.new_low_count}</div>
                        </div>
            `;

            // æç«¯æ¶¨è·Œ
            html += `
                        <div class="raw-data-item">
                            <div class="label">ğŸ”¥ 24hæ¶¨â‰¥10%</div>
                            <div class="value" style="color: #28a745;">${raw.extreme.extreme_up}</div>
                        </div>
                        <div class="raw-data-item">
                            <div class="label">â„ï¸ 24hè·Œâ‰¤-10%</div>
                            <div class="value" style="color: #dc3545;">${raw.extreme.extreme_down}</div>
                        </div>
            `;

            // å…¨ç½‘æŒä»“é‡ï¼ˆç‰¹åˆ«çªå‡ºæ˜¾ç¤ºï¼‰
            const totalPosition = raw.total_position || 0;
            let oiColor = '#6c757d';  // é»˜è®¤ç°è‰²ï¼ˆæ”¹ç”¨oiColoré¿å…é‡å¤å£°æ˜ï¼‰
            let positionText = '';
            
            if (totalPosition < 92) {
                oiColor = '#28a745';  // å¼ºçƒˆåšå¤š - ç»¿è‰²
                positionText = 'å¼ºçƒˆåšå¤šåŒº';
            } else if (totalPosition < 95) {
                oiColor = '#7cb342';  // ä¸€èˆ¬åšå¤š - æµ…ç»¿
                positionText = 'ä¸€èˆ¬åšå¤šåŒº';
            } else if (totalPosition < 100) {
                oiColor = '#9ccc65';  // å¯åšå¤š - æ›´æµ…ç»¿
                positionText = 'å¯åšå¤šåŒº';
            } else if (totalPosition < 110) {
                oiColor = '#ffa726';  // å¯åšç©º - æ©™è‰²
                positionText = 'å¯åšç©ºåŒº';
            } else if (totalPosition < 115) {
                oiColor = '#ff7043';  // ä¸€èˆ¬åšç©º - æµ…çº¢
                positionText = 'ä¸€èˆ¬åšç©ºåŒº';
            } else if (totalPosition >= 115) {
                oiColor = '#dc3545';  // å¼ºçƒˆåšç©º - çº¢è‰²
                positionText = 'å¼ºçƒˆåšç©ºåŒº';
            }
            
            html += `
                        <div class="raw-data-item" style="grid-column: span 2; border: 3px solid ${oiColor}; background: linear-gradient(135deg, ${oiColor}15 0%, ${oiColor}08 100%);">
                            <div class="label" style="font-weight: 700; font-size: 14px;">ğŸ’° å…¨ç½‘æŒä»“é‡ï¼ˆææ…Œæ¸…æ´—æŒ‡æ•°ï¼‰</div>
                            <div class="value" style="color: ${oiColor}; font-size: 28px; margin-bottom: 5px;">${totalPosition.toFixed(2)} äº¿ç¾å…ƒ</div>
                            <div style="font-size: 12px; color: #666; font-weight: 600;">${positionText}</div>
                        </div>
            `;

            html += `
                    </div>
                </div>

                <!-- æ—¶é—´æˆ³ -->
                <div class="timestamp">ğŸ“… æœ€åæ›´æ–°æ—¶é—´: ${data.timestamp}</div>
            `;

            document.getElementById('content').innerHTML = html;
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨åˆ·æ–°
        loadData();

        // æ¯30ç§’è‡ªåŠ¨åˆ·æ–°
        setInterval(loadData, 30000);
    </script>
</body>
</html>
