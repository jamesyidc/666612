<!DOCTYPE html>
<html>
<head>
    <title>æŒä»“æ•°æ®æµ‹è¯•</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #4CAF50; color: white; }
        .loading { color: #999; font-style: italic; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>ğŸ” é”šç‚¹å•æŒä»“æ•°æ®æµ‹è¯•</h1>
    <div id="status" class="loading">æ­£åœ¨åŠ è½½...</div>
    <div id="rawData" style="margin-top: 20px; background: #f5f5f5; padding: 10px; display: none;">
        <h3>åŸå§‹ API æ•°æ®ï¼š</h3>
        <pre id="rawJson"></pre>
    </div>
    <table id="dataTable" style="margin-top: 20px; display: none;">
        <thead>
            <tr>
                <th>å¸ç§</th>
                <th>æ–¹å‘</th>
                <th>æŒä»“é‡ (åŸå§‹)</th>
                <th>æŒä»“é‡ (æ˜¾ç¤º)</th>
                <th>å¼€ä»“ä»·</th>
                <th>æ æ†</th>
            </tr>
        </thead>
        <tbody id="tbody"></tbody>
    </table>
    
    <script>
        fetch('/api/anchor-system/current-positions')
            .then(r => r.json())
            .then(data => {
                document.getElementById('status').textContent = `âœ… åŠ è½½æˆåŠŸ - å…± ${data.total} ä¸ªæŒä»“`;
                document.getElementById('status').className = '';
                
                // æ˜¾ç¤ºåŸå§‹æ•°æ®
                document.getElementById('rawData').style.display = 'block';
                document.getElementById('rawJson').textContent = JSON.stringify(data, null, 2);
                
                // æ¸²æŸ“è¡¨æ ¼
                if (data.positions && data.positions.length > 0) {
                    document.getElementById('dataTable').style.display = 'table';
                    const tbody = document.getElementById('tbody');
                    tbody.innerHTML = data.positions.map(p => `
                        <tr>
                            <td>${p.inst_id}</td>
                            <td>${p.pos_side}</td>
                            <td style="font-weight: bold; color: blue;">${p.pos_size}</td>
                            <td style="font-weight: bold; color: green;">${p.pos_size.toFixed(4)}</td>
                            <td>$${p.avg_price.toFixed(4)}</td>
                            <td>${p.lever}x</td>
                        </tr>
                    `).join('');
                }
            })
            .catch(err => {
                document.getElementById('status').textContent = `âŒ åŠ è½½å¤±è´¥: ${err}`;
                document.getElementById('status').className = 'error';
            });
    </script>
</body>
</html>
