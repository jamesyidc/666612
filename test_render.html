<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>测试渲染</title>
    <style>
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background: #667eea; color: white; }
    </style>
</head>
<body>
    <h2>子账户表格渲染测试</h2>
    <div id="result"></div>
    
    <script>
        // 模拟API数据
        const data = [
            {
                "account_name": "Wu666666",
                "avg_price": 0.0925662830687841,
                "inst_id": "CRO-USDT-SWAP",
                "leverage": "10",
                "maintenance_count": 0,
                "margin": 9.97056,
                "mark_price": 0.09232,
                "notional_usd": 99.602903232,
                "pos_side": "long",
                "pos_size": 108.0,
                "profit_rate": -0.2670461459012741,
                "status": "正常",
                "upl": -0.2659857142868316
            }
        ];
        
        // 币种编号映射
        const coinNumbers = {
            'CRO-USDT-SWAP': 'NO.3'
        };
        
        // 渲染表格
        let html = '<table><thead><tr>';
        html += '<th>账户名</th><th>编号</th><th>币种</th><th>方向</th><th>持仓量</th>';
        html += '<th>开仓均价</th><th>标记价格</th><th>杠杆</th><th>未实现盈亏</th><th>保证金</th>';
        html += '<th>收益率</th><th>今日维护</th><th>状态</th><th>操作</th>';
        html += '</tr></thead><tbody>';
        
        data.forEach(item => {
            const coinNumber = coinNumbers[item.inst_id] || '--';
            const profitColor = item.profit_rate >= 0 ? 'green' : 'red';
            const uplColor = item.upl >= 0 ? 'green' : 'red';
            
            html += '<tr>';
            html += `<td>${item.account_name}</td>`;
            html += `<td>${coinNumber}</td>`;
            html += `<td>${item.inst_id}</td>`;
            html += `<td>做多</td>`;
            html += `<td>${item.pos_size.toFixed(4)}</td>`;
            html += `<td>$${item.avg_price.toFixed(4)}</td>`;
            html += `<td>$${item.mark_price.toFixed(4)}</td>`;
            html += `<td>${item.leverage}x</td>`;
            html += `<td style="color: ${uplColor}">${item.upl >= 0 ? '+' : ''}${item.upl.toFixed(4)} USDT</td>`;
            html += `<td>${item.margin.toFixed(4)} USDT</td>`;
            html += `<td style="color: ${profitColor}">${item.profit_rate >= 0 ? '+' : ''}${item.profit_rate.toFixed(2)}%</td>`;
            html += `<td>${item.maintenance_count}次</td>`;
            html += `<td>${item.status}</td>`;
            html += `<td><button>维护</button></td>`;
            html += '</tr>';
        });
        
        html += '</tbody></table>';
        document.getElementById('result').innerHTML = html;
        
        console.log('渲染的列数:', document.querySelectorAll('th').length);
        console.log('数据行的列数:', document.querySelectorAll('tbody td').length);
    </script>
</body>
</html>
